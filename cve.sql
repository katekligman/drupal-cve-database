CREATE DATABASE IF NOT EXISTS `cve` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;
USE `cve`;

CREATE TABLE IF NOT EXISTS `cve` (
  `advisory_id` varchar(255) NOT NULL,
  `advisory_date` date DEFAULT NULL,
  `advisory_url` varchar(255) NOT NULL,
  `project_name` varchar(255) NOT NULL,
  `project_short_name` varchar(255) NOT NULL,
  `project_url` varchar(255) NOT NULL,
  `project_git_url` varchar(255) NOT NULL,
  `drupal_4` enum('Yes','No') DEFAULT 'No',
  `drupal_5` enum('Yes','No') DEFAULT 'No',
  `drupal_6` enum('Yes','No') DEFAULT 'No',
  `drupal_7` enum('Yes','No') DEFAULT 'No',
  `drupal_8` enum('Yes','No') DEFAULT 'No',
  `s_csrf` enum('Yes','No') DEFAULT 'No',
  `s_sql_injection` enum('Yes','No') DEFAULT 'No',
  `s_open_redirect` enum('Yes','No') DEFAULT 'No',
  `s_xss` enum('Yes','No') DEFAULT 'No',
  `s_arbitrary_code_execution` enum('Yes','No') DEFAULT 'No',
  `s_file_access` enum('Yes','No') DEFAULT 'No',
  `s_access_bypass` enum('Yes','No') DEFAULT 'No',
  `s_information_disclosure` enum('Yes','No') DEFAULT 'No',
  `s_session_fixation` enum('Yes','No') DEFAULT 'No',
  `s_dos` enum('Yes','No') DEFAULT 'No',
  `s_privilege_escalation` enum('Yes','No') DEFAULT 'No',
  `s_spam` enum('Yes','No') DEFAULT 'No',
  `unsupported` enum('Yes','No') DEFAULT 'No',
  `reported_by` text,
  `fixed_by` text,
  `coordinated_by` text
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


ALTER TABLE `cve`
  ADD PRIMARY KEY (`advisory_id`);
